"use strict";(self.webpackChunkserver=self.webpackChunkserver||[]).push([[821],{23544:(We,V,s)=>{s.r(V),s.d(V,{default:()=>Ge});var e=s(92132),x=s(21272),u=s(39747),le=s(11235),oe=s(33544),d=s.n(oe),ne=s(55794),ie=s(43121),L=s(69564),de=s(32559),ce=s(17840),O=s(31127),re=s(28312),f=s(54894),$=s(58272),o=s(56668),K=s(50642),G=s(6479),v=s(57842),U=s(53900),W=s(15926),D=s(43242),S=s(44622),H=s(24122),J=s(44370),C=s(83724),Q=s(32161),X=s(13333),M=s(61535),ge=s(2600),ue=s.n(ge),N=s(82437),B=s(84012);const he=()=>{const[t,l]=(0,x.useState)(!1),n=(0,N.wA)(),a=(0,u.hN)(),{post:i}=(0,u.ry)();return{isAdding:t,addLocale:async r=>{l(!0);try{const{data:g}=await i("/i18n/locales",r);a({type:"success",message:{id:(0,o.g)("Settings.locales.modal.create.success")}}),n({type:B.TI,newLocale:g})}catch(g){const h=ue()(g,"response.payload.message",null);throw h&&h.includes("already exists")?a({type:"warning",message:{id:(0,o.g)("Settings.locales.modal.create.alreadyExist")}}):a({type:"warning",message:{id:"notification.error"}}),g}finally{l(!1)}}}};var R=s(12083);const Y=(0,R.Ik)().shape({code:(0,R.Yj)().required(),displayName:(0,R.Yj)().max(50,"Settings.locales.modal.locales.displayName.error").required(u.iW.required)});var z=s(12050);const me=()=>{const{values:t,setFieldValue:l}=(0,M.j7)(),{formatMessage:n}=(0,f.A)();return(0,e.jsx)(z.S,{hint:n({id:(0,o.g)("Settings.locales.modal.advanced.setAsDefault.hint"),defaultMessage:"One default locale is required, change it by selecting another one"}),onChange:()=>l("isDefault",!t.isDefault),value:t.isDefault,children:n({id:(0,o.g)("Settings.locales.modal.advanced.setAsDefault"),defaultMessage:"Set as default locale"})})};var Z=s(57564),A=s(68065),w=s(81926),fe=s(71262),ve=s(37373),xe=s(70230),je=s(74930);const q=()=>{const{formatMessage:t}=(0,f.A)(),{notifyStatus:l}=(0,xe.W)(),n=(0,u.hN)(),{get:a}=(0,u.ry)(),{isLoading:i,data:c}=(0,je.useQuery)(["plugin-i18n","locales"],async()=>{try{const{data:r}=await a("/i18n/iso-locales");return l(t({id:(0,o.g)("Settings.locales.modal.locales.loaded"),defaultMessage:"The locales have been successfully loaded."})),r}catch{return n({type:"warning",message:{id:"notification.error"}}),[]}});return{defaultLocales:c,isLoading:i}},E=x.memo(({value:t,onClear:l,onLocaleChange:n,error:a})=>{const{formatMessage:i}=(0,f.A)(),{defaultLocales:c,isLoading:r}=q(),{locales:g}=(0,$.A)(),h=(c||[]).map(m=>({label:m.name,value:m.code})).filter(({value:m})=>{const y=g.find(({code:T})=>T===m);return!y||y.code===t}),p=t||"";return(0,e.jsx)(fe.G3,{"aria-busy":r,error:a,label:i({id:(0,o.g)("Settings.locales.modal.locales.label"),defaultMessage:"Locales"}),value:p,onClear:t?l:void 0,onChange:m=>{const y=h.find(T=>T.value===m);y&&n({code:y.value,displayName:y.label})},placeholder:i({id:"components.placeholder.select",defaultMessage:"Select"}),children:h.map(m=>(0,e.jsx)(ve.j,{value:m.value,children:m.label},m.value))})});E.defaultProps={error:void 0,value:void 0,onClear(){},onLocaleChange:()=>{}},E.propTypes={error:d().string,onClear:d().func,onLocaleChange:d().func,value:d().string};const ye=E,pe=()=>{const{formatMessage:t}=(0,f.A)(),{values:l,handleChange:n,setFieldValue:a,errors:i}=(0,M.j7)(),c=(0,x.useCallback)(g=>{a("displayName",g.displayName),a("code",g.code)},[a]),r=(0,x.useCallback)(()=>{a("displayName",""),a("code","")},[a]);return(0,e.jsxs)(Z.x,{gap:4,children:[(0,e.jsx)(A.E,{col:6,children:(0,e.jsx)(ye,{error:i.code,value:l.code,onLocaleChange:c,onClear:r})}),(0,e.jsx)(A.E,{col:6,children:(0,e.jsx)(w.k,{name:"displayName",label:t({id:(0,o.g)("Settings.locales.modal.locales.displayName"),defaultMessage:"Locale display name"}),hint:t({id:(0,o.g)("Settings.locales.modal.locales.displayName.description"),defaultMessage:"Locale will be displayed under that name in the administration panel"}),error:i.displayName?t({id:(0,o.g)("Settings.locales.modal.locales.displayName.error"),defaultMessage:"The locale display name can only be less than 50 characters."}):void 0,value:l.displayName,onChange:n})})]})},Le={code:"",displayName:"",isDefault:!1},k=({onClose:t})=>{const{isAdding:l,addLocale:n}=he(),{formatMessage:a}=(0,f.A)(),{refetchPermissions:i}=(0,u.r5)(),c=async r=>{await n({code:r.code,name:r.displayName,isDefault:r.isDefault}),await i()};return(0,e.jsx)(K.k,{onClose:t,labelledBy:"add-locale-title",children:(0,e.jsx)(M.l1,{initialValues:Le,onSubmit:c,validationSchema:Y,validateOnChange:!1,children:(0,e.jsxs)(u.lV,{children:[(0,e.jsx)(G.r,{children:(0,e.jsx)(v.o,{fontWeight:"bold",textColor:"neutral800",as:"h2",id:"add-locale-title",children:a({id:(0,o.g)("Settings.list.actions.add"),defaultMessage:"Add new locale"})})}),(0,e.jsx)(U.c,{children:(0,e.jsxs)(W.f,{label:a({id:(0,o.g)("Settings.locales.modal.title"),defaultMessage:"Configurations"}),id:"tabs",variant:"simple",children:[(0,e.jsxs)(D.s,{justifyContent:"space-between",children:[(0,e.jsx)(v.o,{as:"h2",variant:"beta",children:a({id:(0,o.g)("Settings.locales.modal.title"),defaultMessage:"Configurations"})}),(0,e.jsxs)(S.t,{children:[(0,e.jsx)(S.o,{children:a({id:(0,o.g)("Settings.locales.modal.base"),defaultMessage:"Basic settings"})}),(0,e.jsx)(S.o,{children:a({id:(0,o.g)("Settings.locales.modal.advanced"),defaultMessage:"Advanced settings"})})]})]}),(0,e.jsx)(H.c,{}),(0,e.jsx)(J.a,{paddingTop:7,paddingBottom:7,children:(0,e.jsxs)(C.T,{children:[(0,e.jsx)(C.K,{children:(0,e.jsx)(pe,{})}),(0,e.jsx)(C.K,{children:(0,e.jsx)(me,{})})]})})]})}),(0,e.jsx)(Q.j,{startActions:(0,e.jsx)(L.$,{variant:"tertiary",onClick:t,children:a({id:"app.components.Button.cancel",defaultMessage:"Cancel"})}),endActions:(0,e.jsx)(L.$,{type:"submit",startIcon:(0,e.jsx)(X.A,{}),disabled:l,children:a({id:"global.save",defaultMessage:"Save"})})})]})})})};k.propTypes={onClose:d().func.isRequired};const Se=k,Ce=()=>{const[t,l]=(0,x.useState)(!1),n=(0,N.wA)(),a=(0,u.hN)(),{del:i}=(0,u.ry)();return{isDeleting:t,deleteLocale:async r=>{try{l(!0),await i(`/i18n/locales/${r}`),a({type:"success",message:{id:(0,o.g)("Settings.locales.modal.delete.success")}}),n({type:B.V2,id:r})}catch{a({type:"warning",message:{id:"notification.error"}})}finally{l(!1)}}}},b=({localeToDelete:t,onClose:l})=>{const{isDeleting:n,deleteLocale:a}=Ce(),i=Boolean(t),c=()=>a(t.id).then(l);return(0,e.jsx)(u.TM,{isConfirmButtonLoading:n,onConfirm:c,onToggleDialog:l,isOpen:i})};b.defaultProps={localeToDelete:void 0},b.propTypes={localeToDelete:d().shape({id:d().number.isRequired}),onClose:d().func.isRequired};const Me=b,Te=()=>{const[t,l]=(0,x.useState)(!1),n=(0,N.wA)(),a=(0,u.hN)(),{put:i}=(0,u.ry)();return{isEditing:t,editLocale:async(r,g)=>{try{l(!0);const{data:h}=await i(`/i18n/locales/${r}`,g);a({type:"success",message:{id:(0,o.g)("Settings.locales.modal.edit.success")}}),n({type:B.JX,editedLocale:h})}catch{a({type:"warning",message:{id:"notification.error"}})}finally{l(!1)}}}},_=({isDefaultLocale:t})=>{const{values:l,setFieldValue:n}=(0,M.j7)(),{formatMessage:a}=(0,f.A)();return(0,e.jsx)(z.S,{name:"isDefault",hint:a({id:(0,o.g)("Settings.locales.modal.advanced.setAsDefault.hint"),defaultMessage:"One default locale is required, change it by selecting another one"}),onChange:()=>n("isDefault",!l.isDefault),value:l.isDefault,disabled:t,children:a({id:(0,o.g)("Settings.locales.modal.advanced.setAsDefault"),defaultMessage:"Set as default locale"})})};_.propTypes={isDefaultLocale:d().bool.isRequired};const Ae=_;var De=s(45024),Ne=s(89787);const ee=({locale:t})=>{const{formatMessage:l}=(0,f.A)(),{values:n,handleChange:a,errors:i}=(0,M.j7)(),{defaultLocales:c,isLoading:r}=q(),g=!r&&c.find(h=>h.code===t.code);return(0,e.jsxs)(Z.x,{gap:4,children:[(0,e.jsx)(A.E,{col:6,children:(0,e.jsx)(De.l,{label:l({id:(0,o.g)("Settings.locales.modal.locales.label"),defaultMessage:"Locales"}),value:g?.code||t.code,disabled:!0,children:(0,e.jsx)(Ne.c,{value:g?.code||t.code,children:g?.name||t.code})})}),(0,e.jsx)(A.E,{col:6,children:(0,e.jsx)(w.k,{name:"displayName",label:l({id:(0,o.g)("Settings.locales.modal.locales.displayName"),defaultMessage:"Locale display name"}),hint:l({id:(0,o.g)("Settings.locales.modal.locales.displayName.description"),defaultMessage:"Locale will be displayed under that name in the administration panel"}),error:i.displayName?l({id:(0,o.g)("Settings.locales.modal.locales.displayName.error"),defaultMessage:"The locale display name can only be less than 50 characters."}):void 0,value:n.displayName,onChange:a})})]})},Be=ee;ee.propTypes={locale:d().shape({id:d().number.isRequired,name:d().string.isRequired,code:d().string.isRequired,isDefault:d().bool.isRequired}).isRequired};const F=({locale:t,onClose:l})=>{const{refetchPermissions:n}=(0,u.r5)(),{isEditing:a,editLocale:i}=Te(),{formatMessage:c}=(0,f.A)(),r=async({displayName:g,isDefault:h})=>{await i(t.id,{name:g,isDefault:h}),await n()};return(0,e.jsx)(K.k,{onClose:l,labelledBy:"edit-locale-title",children:(0,e.jsx)(M.l1,{initialValues:{code:t?.code,displayName:t?.name||"",isDefault:Boolean(t?.isDefault)},onSubmit:r,validationSchema:Y,children:(0,e.jsxs)(u.lV,{children:[(0,e.jsx)(G.r,{children:(0,e.jsx)(v.o,{fontWeight:"bold",textColor:"neutral800",as:"h2",id:"edit-locale-title",children:c({id:(0,o.g)("Settings.list.actions.edit"),defaultMessage:"Edit a locale"})})}),(0,e.jsx)(U.c,{children:(0,e.jsxs)(W.f,{label:c({id:(0,o.g)("Settings.locales.modal.title"),defaultMessage:"Configurations"}),id:"tabs",variant:"simple",children:[(0,e.jsxs)(D.s,{justifyContent:"space-between",children:[(0,e.jsx)(v.o,{as:"h2",children:c({id:(0,o.g)("Settings.locales.modal.title"),defaultMessage:"Configurations"})}),(0,e.jsxs)(S.t,{children:[(0,e.jsx)(S.o,{children:c({id:(0,o.g)("Settings.locales.modal.base"),defaultMessage:"Basic settings"})}),(0,e.jsx)(S.o,{children:c({id:(0,o.g)("Settings.locales.modal.advanced"),defaultMessage:"Advanced settings"})})]})]}),(0,e.jsx)(H.c,{}),(0,e.jsx)(J.a,{paddingTop:7,paddingBottom:7,children:(0,e.jsxs)(C.T,{children:[(0,e.jsx)(C.K,{children:(0,e.jsx)(Be,{locale:t})}),(0,e.jsx)(C.K,{children:(0,e.jsx)(Ae,{isDefaultLocale:Boolean(t&&t.isDefault)})})]})})]})}),(0,e.jsx)(Q.j,{startActions:(0,e.jsx)(L.$,{variant:"tertiary",onClick:l,children:c({id:"app.components.Button.cancel"})}),endActions:(0,e.jsx)(L.$,{type:"submit",startIcon:(0,e.jsx)(X.A,{}),disabled:a,children:c({id:"global.save"})})})]})})})};F.defaultProps={locale:void 0},F.propTypes={locale:d().shape({id:d().number.isRequired,name:d().string.isRequired,code:d().string.isRequired,isDefault:d().bool.isRequired}),onClose:d().func.isRequired};const Re=F;var Ee=s(79318),be=s(70768),se=s(34508),j=s(21270),Fe=s(96586),Pe=s(83314),ae=s(19106),Ie=s(31708),Ve=s(39423);const P=({locales:t,onDeleteLocale:l,onEditLocale:n})=>{const{formatMessage:a}=(0,f.A)();return(0,e.jsxs)(Ee.X,{colCount:4,rowCount:t.length+1,children:[(0,e.jsx)(be.d,{children:(0,e.jsxs)(se.Tr,{children:[(0,e.jsx)(j.Th,{children:(0,e.jsx)(v.o,{variant:"sigma",textColor:"neutral600",children:a({id:(0,o.g)("Settings.locales.row.id")})})}),(0,e.jsx)(j.Th,{children:(0,e.jsx)(v.o,{variant:"sigma",textColor:"neutral600",children:a({id:(0,o.g)("Settings.locales.row.displayName")})})}),(0,e.jsx)(j.Th,{children:(0,e.jsx)(v.o,{variant:"sigma",textColor:"neutral600",children:a({id:(0,o.g)("Settings.locales.row.default-locale")})})}),(0,e.jsx)(j.Th,{children:(0,e.jsx)(Fe.s,{children:"Actions"})})]})}),(0,e.jsx)(Pe.N,{children:t.map(i=>(0,e.jsxs)(se.Tr,{...(0,u.qM)({fn:()=>n(i),condition:n}),children:[(0,e.jsx)(j.Td,{children:(0,e.jsx)(v.o,{textColor:"neutral800",children:i.id})}),(0,e.jsx)(j.Td,{children:(0,e.jsx)(v.o,{textColor:"neutral800",children:i.name})}),(0,e.jsx)(j.Td,{children:(0,e.jsx)(v.o,{textColor:"neutral800",children:i.isDefault?a({id:(0,o.g)("Settings.locales.default")}):null})}),(0,e.jsx)(j.Td,{children:(0,e.jsxs)(D.s,{gap:1,justifyContent:"flex-end",...u.dG,children:[n&&(0,e.jsx)(ae.K,{onClick:()=>n(i),label:a({id:(0,o.g)("Settings.list.actions.edit")}),icon:(0,e.jsx)(Ie.A,{}),noBorder:!0}),l&&!i.isDefault&&(0,e.jsx)(ae.K,{onClick:()=>l(i),label:a({id:(0,o.g)("Settings.list.actions.delete")}),icon:(0,e.jsx)(Ve.A,{}),noBorder:!0})]})})]},i.id))})]})};P.defaultProps={locales:[],onDeleteLocale:void 0,onEditLocale:void 0},P.propTypes={locales:d().array,onDeleteLocale:d().func,onEditLocale:d().func};const Oe=P,I=({canUpdateLocale:t,canDeleteLocale:l,onToggleCreateModal:n,isCreating:a})=>{const[i,c]=(0,x.useState)(),[r,g]=(0,x.useState)(),{locales:h}=(0,$.A)(),{formatMessage:p}=(0,f.A)();(0,u.L4)();const m=()=>c(void 0),y=l?c:void 0,T=()=>g(void 0),Ue=t?g:void 0;return(0,e.jsxs)(ne.g,{tabIndex:-1,children:[(0,e.jsx)(ie.Q,{primaryAction:(0,e.jsx)(L.$,{startIcon:(0,e.jsx)(O.A,{}),onClick:n,size:"S",children:p({id:(0,o.g)("Settings.list.actions.add")})}),title:p({id:(0,o.g)("plugin.name")}),subtitle:p({id:(0,o.g)("Settings.list.description")})}),(0,e.jsx)(de.s,{children:h?.length>0?(0,e.jsx)(Oe,{locales:h,onDeleteLocale:y,onEditLocale:Ue}):(0,e.jsx)(ce.p,{icon:(0,e.jsx)(re.A,{width:void 0,height:void 0}),content:p({id:(0,o.g)("Settings.list.empty.title")}),action:n?(0,e.jsx)(L.$,{variant:"secondary",startIcon:(0,e.jsx)(O.A,{}),onClick:n,children:p({id:(0,o.g)("Settings.list.actions.add")})}):null})}),a&&(0,e.jsx)(Se,{onClose:n}),r&&(0,e.jsx)(Re,{onClose:T,locale:r}),(0,e.jsx)(Me,{localeToDelete:i,onClose:m})]})};I.defaultProps={onToggleCreateModal:void 0},I.propTypes={canUpdateLocale:d().bool.isRequired,canDeleteLocale:d().bool.isRequired,onToggleCreateModal:d().func,isCreating:d().bool.isRequired};const $e=I,te=({canReadLocale:t,canCreateLocale:l,canDeleteLocale:n,canUpdateLocale:a})=>{const[i,c]=(0,x.useState)(!1),r=l?()=>c(g=>!g):void 0;return t?(0,e.jsx)($e,{canUpdateLocale:a,canDeleteLocale:n,onToggleCreateModal:r,isCreating:i}):null};te.propTypes={canReadLocale:d().bool.isRequired,canCreateLocale:d().bool.isRequired,canUpdateLocale:d().bool.isRequired,canDeleteLocale:d().bool.isRequired};const Ke=te,Ge=()=>{const{isLoading:t,allowedActions:{canRead:l,canUpdate:n,canCreate:a,canDelete:i}}=(0,u.ec)(le.J);return t?null:(0,e.jsx)(Ke,{canReadLocale:l,canCreateLocale:a,canUpdateLocale:n,canDeleteLocale:i})}}}]);
